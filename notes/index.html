<!DOCTYPE html>
<html lang="en" manifest="notes.appcache">
  <head>
    <meta charset="utf-8">
    <title>Notes</title>
    <style>
      html { height: 100%; }
      body { 
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
      }
      textarea {
        box-sizing: border-box;
        margin: 0;
        border: 0;
        padding: 0.5em;
        width: 100%;
        height: 100%;
        overflow-x: hidden;
        overflow-y: scroll;
        background: #000;
        color: #0f0;
      }
    </style>
  </head>
  <body>
    <textarea placeholder="notes here"></textarea>
    <script>
      var ta = document.querySelector('textarea'),
          hash = location.hash,
          selStart = parseInt(localStorage['selectionStart' + hash] || '0', 10),
          selEnd = parseInt(localStorage['selectionEnd' + hash] || '0', 10);
      ta.value = localStorage['notes' + hash] || '';
      ta.setSelectionRange(selStart, selEnd);
      ta.focus();
      function save() {
        localStorage['notes' + hash] = ta.value;
        localStorage['selectionStart' + hash] = ta.selectionStart;
        localStorage['selectionEnd' + hash] = ta.selectionEnd;
      }
      ta.addEventListener('change', save, true);
      ta.addEventListener('blur', save, true);
      window.addEventListener('hashchange', function() {
        location.reload();
      }, true);
    </script>
  </body>
</html>
